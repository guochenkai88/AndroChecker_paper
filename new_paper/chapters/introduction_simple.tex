\section{Introduction}
%With the rapid development of mobile devices, interactions with such devices have already become indispensable in people's daily life. To meet users' increasing service demands on mobile devices, there has been a surge in developing mission-critical programs running on the devices, called \textit{apps}. Nowadays, despite the fact that Android apps have dominated the mobile market, there are still a large amount of apps being produced every day. Consequently, the growing number of apps also raise the quality concerns, e.g., potential bugs and security issues. How to verify the correctness and security of such apps has become a critical concern for both developers and users.

Correctness and security of Android apps has become a critical concern and thus verification is needed.
%
%Event-driven, which is a representative feature in Android systems, is well-known as the cause of intractable issues on testing and verification. 
However, traditional flow analysis \cite{new1976program, new1978dataflow} is hard to be directly adopted to Android apps, since Android apps do not have a fixed program entry. A promising way of static analysis is to create models of an Android app rather than directly analysing the app source code, due to its event-driven structures (e.g, listener interfaces, event callbacks, etc.). There are two ways of app modelling: \textit{callback-directed} \cite{new2013contextual,new2015static} and \textit{data-directed} \cite{new2014flowdroid, new2015DroidSafe}. Callback-directed modelling captures event-callback sequences within the targeted app and represents them as a variation of control flow graph (\textit{CFG}); whereas data-directed modelling identifies types of information related to the analysis goal and combines this information according to the flow sequences. The former way is more versatile and is able to provide logical structure over the entire app program. However, it can hardly provide concrete assist for analysis in practical scenarios, since most of the modelling targets, functionality testing or security verification, are closely combined with solid data input and output.
Data-directed modelling has advantages in tackling specific analysis, but has a heavy cost in constructing a generic model. 
Neither of them is able to conduct a callback model in a generic and fine-grained manner. 

%The reason is that Android is equipped with many complex features such as inter-process communication and vast callback SDKs (Software Development Kit). As a result, the generated model by existing works, such as \cite{new2013contextual,new2015static, new2015window}, is incomplete. 

In more details, prior app modelling suffers from incompleteness in three aspects. 1) Component types: only \texttt{activity} is involved in the modelling; other components like \texttt{service} and \texttt{broadcast receiver} are ignored. However, security compromises and logic bugs frequently exist in \texttt{service} and \texttt{broadcast receiver} components. 2) Callback types: only callbacks related to lifecycle and user interaction are taken into consideration. Actually, in Android, a variety of callbacks are driven by system events, like phone and location status. 
%Although these system-driven callbacks are invoked invisibly, they are of great importance in analysing certain system status. 
3) Path-insensitive: in the existing callback modelling, the generated edges only present a \textit{possible} flow from a start node to an end node, ignoring information such as how and when the flow is executed. There lacks a valid way to handle the conditions of the execution of possible flows.
 
%In practice, merely offering a group of \textit{possible} paths has limited help to analysis. For example, techniques for test case generation normally need to confirm the condition ranges for specifying certain program paths. In other words, the test-cases are determined by the condition data rather than the paths themselves.Therefore, constructing a path-sensitive model benefits advanced application based on the model.
   

In this work, we develop an approach for constructing generic path-sensitive callback (\textit{GPC} for short) model for Android apps.
%we develop a generic, event-callback related modelling approach to handle the critical condition data that impacts the direction of control flows, such that our approach has both of the advantages of callback-directed and data-directed modelling. %To achieve the goal,  
There are three key insights underlying our approach: 1) components like \texttt{service} run in a parallel way with other components; 2) each of the non-lifecycle callbacks needs to register itself in their parent callbacks before execution; 3) the callback execution condition can be identified by analysing the register implementation along with possible paths. Our approach leverages the above insights to fully automate the model construction via static program analysis. 
%
We design and implement a proof-of-concept model builder AndroChecker, which receives Android \textit{apk} files as input and outputs their corresponding \textit{GPC} models. We apply AndroChecker to $20$ real-world apps. The evaluation results show that our technique is both accurate and complete. 

%The main contributions of this paper can be concluded as follows: 
%\begin{itemize}
%\item First, we defined the \textit{GPC} model, a generic path-sensitive callback model, which facilitates the understanding, testing and statically verifying Android apps.
%\item Second, we proposed an algorithm to automatically construct the \textit{GPC} model, by adopting backward data dependency analysis.
%\item Third, we implemented the algorithm as a proof-of-concept model builder AndroChecker.
%\item Fourth, we performed experimental evaluation on 20 real-world apps, as well as three case studies, which confirms the correctness and efficiency of our method and tool.
%\end{itemize}

%Insight: 1) most of the firing of callbacks must obey specific conditions, which is relevant to not only resource file\cite{}, but also data dependency.
%2) the same callback varies under different driven.(prefix sensitive)
%3) There exists impact between intra-components.(create a novel graph)
%
%In this work, we focus on constructing a generic, deep context-sensitive, cross-components framework for callback transition analysis. We seek to solve a problem 
%
%Our approach is based on deep context reasoning
